/*!
 * @license
 * Palikka v1.0.0-beta
 * https://github.com/niklasramo/palikka
 * Copyright (c) 2016 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
!function(e,n){"function"==typeof define&&define.amd?define([],function(){return n(e)}):"object"==typeof module&&module.exports?module.exports=n(e):e.Palikka=n(e)}(this,function(e,n){"use strict";function t(e,t,r,o){function d(n){f.ready=!0,f.value=n;for(var r=e._queues,i=r[t]=(r[t]||[]).slice(0),u=0;u<i.length;u++)i[u](f)}function a(e,n){if("function"==typeof o){var r=!1,i=o.apply({id:t,dependencies:n,defer:function(e){r=!0,e(function(e){d(e)})}},e);r||d(i)}else d(o)}var f=this;if(t&&"string"==typeof t||c("Module must have an id (string)."),!e._modules[t]){-1!==r.indexOf(t)&&c("Module can not have itself as a dependency.");var s;r.length&&(s=u.call(e,t,r))&&c("Circular dependency between "+t+" and "+s+"."),f.id=t,f.order=++e._counter,f.dependencies=r,f.ready=!1,f.value=n,e._modules[t]=f,r.length?i.call(e,r,a):a([],{})}}function r(){this._modules={},this._queues={},this._counter=0}function i(e,n){for(var t=this,r=[].concat(e),i=r.length,u=0,o=[],d={},a=function(e,t){o[e]=t.value,d[t.id]=t.value,++u===i&&n(o,d)},f=0;f<r.length;f++)!function(e){var n=r[e];n&&"string"==typeof n||c("Module must have an id (string).");var i=t._modules[n];if(i&&i.ready)a(e,i);else{var u=t._queues,o=u[n]=u[n]||[];o[o.length]=function(n){a(e,n)}}}(f)}function u(e,n){for(var t=null,r=0;r<n.length;r++){var i=this._modules[n[r]],u=i?i.dependencies.indexOf(e):-1;if(-1!==u){t=i.dependencies[u];break}}return t}function o(e){return{id:e.id,order:e.order,dependencies:e.dependencies,ready:e.ready,value:e.value}}function d(e,n){for(var t="",n="function"==typeof n?n:a,r=this._modules,i=(e?[].concat(e):Object.keys(r)).filter(function(e){return r[e]}).map(function(e){return o(r[e])}).sort(function(e,n){return e.order<n.order?-1:e.order>n.order?1:0}),u=0;u<i.length;u++){var d=r[u],c=d.ready?s:l;t+=n(d.id,null,c);for(var f=0;f<d.dependencies.length;f++){var p=d.dependencies[f],v=r[p],y=v?v.ready?s:l:h;t+=n(p,d.id,y)}}return t}function a(e,n,t){return(n?"    ":"")+p[t]+" "+e+"\n"}function c(e){throw new Error("[Palikka] "+e)}var f=new r,s="ready",l="loading",h="undefined",p={ready:"[v]",loading:"[o]",undefined:"[x]"};return r.define=function(e,n,t){var i=arguments.length;return i>2?f.define(e,n,t):i>1?f.define(e,n):f.define(e),r},r.require=function(e,n){return f.require(e,n),r},r.status=function(e,n){return f.status(e,n)},r.data=function(){return f.data()},r.prototype.define=function(e,n,r){var i=arguments.length>2,e=[].concat(e),u=i?[].concat(n):[],r=i?r:n;e.length||c("define method must have id(s).");for(var o=0;o<e.length;o++)new t(this,e[o],u,r);return this},r.prototype.require=function(e,n){return e=[].concat(e),e.length||c("require method must have id(s)."),"function"!=typeof n&&c("require method must have a callback function."),i.call(this,e,function(e,t){n.apply(t,e)}),this},r.prototype.status=function(e,n){return d.call(this,e,n)},r.prototype.data=function(){for(var e=this._modules,n=Object.keys(e),t={},r=0;r<n.length;r++)t[n[r]]=o(e[n[r]]);return t},r});